<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>QRコード表示</title>
  <meta name="theme-color" content="#ffffff" />
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="icon" href="./icons/icon-192.png" sizes="192x192">
  <link rel="icon" href="./icons/icon-512.png" sizes="512x512">
  <style>
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", sans-serif; margin: 0; padding: 1rem; background: #fff; text-align: center; }
    h1 { font-size: 1.2rem; margin: 1rem 0; }
    .qr-block { margin: 2rem 0; }
    .qrcode { margin-top: 1rem; }
    .action-buttons { margin-top: 2rem; }
    .action-buttons button {
      padding: 0.6rem 1rem;
      border: none;
      border-radius: 8px;
      background: #0ea5e9;
      color: white;
      font-weight: 600;
      cursor: pointer;
      margin: 0.5rem;
    }

    /* 印刷時のスタイル調整 */
    @media print {
      body {
        padding: 0;
        margin: 0;
      }
      .action-buttons, h1, #download1, #download2 {
        display: none; /* 印刷時に非表示にする要素 */
      }
    }
  </style>
</head>
<body>
  <h1>QRコード表示</h1>

  <div class="qr-block">
    <div id="label1"></div>
    <div id="qrcode1" class="qrcode"></div>
  </div>

  <div class="qr-block">
    <div id="label2"></div>
    <div id="qrcode2" class="qrcode"></div>
  </div>
  
  <div class="action-buttons">
    <button id="print-pdf-btn">PDFとして保存</button>
  </div>

  <script defer src="./qrcode.min.js"></script>
  <script>
    function generateQR(text, size, ec, target) {
      target.innerHTML = "";
      if (!text.trim()) return;
      new QRCode(target, {
        text: text,
        width: parseInt(size, 10),
        height: parseInt(size, 10),
        correctLevel: QRCode.CorrectLevel[ec] || QRCode.CorrectLevel.M
      });
    }

    // URLパラメータから取得
    const params = new URLSearchParams(window.location.search);

    // QR1
    document.getElementById("label1").textContent = params.get("label1") || "";
    generateQR(
      params.get("text1") || "",
      params.get("size1") || "512",
      params.get("ec1") || "M",
      document.getElementById("qrcode1")
    );

    // QR2
    document.getElementById("label2").textContent = params.get("label2") || "";
    generateQR(
      params.get("text2") || "",
      params.get("size2") || "512",
      params.get("ec2") || "M",
      document.getElementById("qrcode2")
    );

    // PDFとして保存機能
    document.getElementById("print-pdf-btn").addEventListener("click", () => {
      window.print();
    });
  </script>
</body>
</html>
